process MCCand = {
#includes
include "FWCore/MessageLogger/data/MessageLogger.cfi"
include "SimGeneral/HepPDTESSource/data/pythiapdt.cfi"
include "PhysicsTools/HepMCCandAlgos/data/genParticleCandidates.cfi"
include "PhysicsTools/HepMCCandAlgos/data/setMotherReferences.cfi"
include "PhysicsTools/RecoCandAlgos/data/allTracks.cfi"

#services
  service = Tracer { 
    untracked string indention = ">>" 
  }

#event source
  source = PoolSource {
    untracked vstring fileNames = { "file:events.root" }
  }

#modules
  module rhos = CandCombiner {
    string decay = "allTracks@+ allTracks@-"
    string cut = "0 < mass < 2.5"
  }

  module mcMatch = MCTruthDeltaRMatcher {
    InputTag src = allTracks
    InputTag matched = genParticleCandidates
    double distMin = 0.1
  }

  module compMatch = MCTruthCompositeMatcher {
    InputTag src = rhos
    InputTag matchMap = mcMatch
  }

  module histo = CandHistoAnalyzer {
   InputTag src = rhos
   untracked string histoutputFile = "histo.root"
   double massMin = 0
   double massMax = 2
   double ptMax = 100
  }

#output modules
  module out = PoolOutputModule { 
    untracked string fileName = "genanal.root" 
    untracked vstring outputCommands = {
      "keep *"
    }  
  }

  module printEventNumber = AsciiOutputModule { }

#paths
  path gen = { 
    genParticleCandidates, setMotherReferences 
  }

  path reco = {
    allTracks, rhos 
  }

  path match = {
    mcMatch, compMatch
  }

  path analysis = {
    histo
  }

  endpath o = { 
    out, printEventNumber 
  }
}
